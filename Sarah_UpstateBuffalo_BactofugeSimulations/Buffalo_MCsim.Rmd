---
title: "MCsim"
author: "Sarah I. Murphy, Samantha Lau, Timothy Lott, Aljosa Trmcic"
date: "2/14/2020"
output: pdf_document
---

The authors listed above are current contributors to this file. Earlier versions were the work of Ariel Buehler and Michael Phillips. Review README.md [https://github.com/FSL-MQIP/MC-2020/blob/master/README.md] for more information.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Set-up environment
* load packages
* load functions
* set seed for reproducibilty
```{r}
## load packages
library(readr)
library(tidyverse)
library(censReg)
library(fitdistrplus)
library(splitstackshape)
library(rmutil)

## load functions
source("UtilityFunctions.R")

## set seed
set.seed(1)
```

## 2. Load input files
* load
```{r, warning=FALSE,message=FALSE}
# (a) AT/ST frequency data
# spore
spore_ATfrequency_file <- "Ariel_2017MC_SporeModel/InputFiles/ColdgrowATFreq_CrossSect.csv"
spore_ATfreq_import <- read.csv(spore_ATfrequency_file, stringsAsFactors = FALSE, header = TRUE)
# ppc
ppc_STfrequency_file <- "Sarah_UpstateBuffalo_BactofugeSimulations/freq_16S_ppc.csv"
ppc_STfreq_import <- read.csv(ppc_STfrequency_file, stringsAsFactors = FALSE, header = TRUE)

# (b) growth parameter data; make sure this contains growth parameters & growth model name
# spore 
spore_growth_file <- "Ariel_2017MC_SporeModel/InputFiles/GrowthParameters.csv" 
spore_growth_import <-read.csv(spore_growth_file, stringsAsFactors = FALSE)
# ppc
ppc_growth_file <- "Sam_FFAR_PPCmodel/InputFiles/ST_percentidentity_MCinput_SL_021920.csv" 
ppc_growth_import <-read.csv(ppc_growth_file, stringsAsFactors = FALSE)

# (c) initial microbial count data
# spore
spore_init_file <- read.csv("Ariel_2017MC_SporeModel/InputFiles/CrossSectional_RawMPN_3.6.17.csv")
# ppc
ppc_init_file <- read_csv("Sarah_UpstateBuffalo_BactofugeSimulations/micro_ppc.csv")

# (d) temperature data for each stage (Note for Sarah to fix temp_stages format)
# temp_stages_file <- "temp_stages.csv"
# temp_by_stage <- read.csv(temp_stages_file, stringsAsFactors = F, comment.char = "#")

# (e) PPC frequency data
# source("FreqPPC.R")
freq_spoilageType <- read_csv("Sarah_UpstateBuffalo_BactofugeSimulations/freq_spoilagetype.csv")
```

* Change stuff so it's for Upstate Buffalo only
```{r}
freq_spoilageType <- freq_spoilageType %>%
  filter(Plant == "Upstate Buffalo")

ppc_init_file <- ppc_init_file %>%
  filter(Plant == "Upstate Buffalo")

ppc_STfreq_import <- ppc_STfreq_import %>%
  filter(Plant == "Upstate Buffalo")
```

* What's PPC for Buffalo for each VSL?
```{r}
# this is how to get the average spoilage type
# freq_spoilageType_byVSLNumber <- freq_spoilageType %>%
#   group_by(VSLNumber,spoilagetype) %>%
#   summarize(n=n())%>%
#   mutate(freq = n / sum(n))
# 
# mean_freq_spoilageType <- freq_spoilageType_byVSLNumber %>%
#   group_by(spoilagetype) %>%
#   summarize(mean_freq=mean(freq),
#             mean_freq_per=mean_freq*100)
# 
# PPC_freq <- expandRows(mean_freq_spoilageType,'mean_freq_per')$spoilagetype
# PPC_freq<-as.vector(PPC_freq)

# this is worst VSL for Buffalo; VSL 434
# Worst_freq_spoilageType <- freq_spoilageType %>%
#   filter(VSLNumber=="434")
# PPC_freq <- as.character(Worst_freq_spoilageType$spoilagetype)

# this is the "best case" where PPC = 0
Best_freq_spoilageType <- freq_spoilageType %>%
  filter(VSLNumber=="436")
PPC_freq <- as.character(Best_freq_spoilageType$spoilagetype)

```

* Check input files for spore & ppc have the same structure and then modify here as necessary to match
```{r}
# modify frequency data file structure for ppc to match spore and also added "ST_" and "AT_", respectively to aid analysis
ppc_STfreq_import <- ppc_STfreq_import %>% 
  rename(RealAT = X16S.ST)
ppc_STfreq_import$ClosestST <- ppc_STfreq_import$RealAT
ppc_STfreq_import <- ppc_STfreq_import[c(5:6)]
ppc_STfreq_import$temp <- "ST"
#remove NA
ppc_STfreq_import <- ppc_STfreq_import %>%
  filter(is.na(ClosestST)!=TRUE)
ppc_STfreq_import$ClosestST <- paste(ppc_STfreq_import$temp,ppc_STfreq_import$ClosestST,sep="_")

# remove any STorAT that doesn't have growth data, but need to find closest before run actually
ppc_STfreq_import <- ppc_STfreq_import %>%
  filter(RealAT != 42)

spore_ATfreq_import$temp <- "AT"
spore_ATfreq_import$ClosestAT <- paste(spore_ATfreq_import$temp,spore_ATfreq_import$ClosestAT,sep="_")

# modify growth import data file structure and also added "ST_" and "AT_", respectively to aid analysis
ppc_growth_import <- ppc_growth_import %>% 
  rename(STorAT = ST,
         mumax = mu,
         LOG10N0 = N0,
         LOG10Nmax = Nmax,
         model_name = modelname)  
ppc_growth_import$temp <- "ST"
ppc_growth_import$STorAT <- paste(ppc_growth_import$temp,ppc_growth_import$STorAT,sep="_")

spore_growth_import <- spore_growth_import %>%
  .[c(1:5)]%>%
  rename(STorAT = rpoBAT)
spore_growth_import$model_name <- "buchanan" #may change later
spore_growth_import$temp <- "AT"
spore_growth_import$STorAT <- paste(spore_growth_import$temp,spore_growth_import$STorAT,sep="_")

ppc_init_file <- ppc_init_file %>%
  filter(is.na(Log10CFU_Initial_2logRed)!=TRUE)%>%
  .[c(7,20,21)]%>%
  rename(log10CFU = Log10CFU_Initial_2logRed)
ppc_init_file$CFU <- 10^ppc_init_file$log10CFU
```

## 3. Set-up dataframe

i. Set important parameters for running the simulation:
```{r}
# (a) n_sim
# Definition: Number of simulations to run (also referred to as the number of bulk tanks in earlier code; i.e., 1 simulation unit = 1 lot of milk)
n_sim <-100 #can use any n_sim for testing code, but need to change to at least 10k when running experiments

# (b) n_units 
# Definition: Number of units per lot (currently, half gallon units) 
n_units <- 10

# (c) start_day 
# Definition: First time point (in days) in unit's shelf life to simulate
start_day <- 1 

# (d) end_day 
# Definition: Last time point (in days) in unit's shelf life to simulate
end_day <- 35 
n_day <- 35 # seems like this is the end_day, but keeping code below for now in case my interpretation is wrong
```

ii. Prep vectors using defined values above
```{r}
# (a) lot_id
#Make a vector for "lot_id" by repeating sequence of 1:n_sim for length of n_units * n_day
lot_id <- rep(seq(1, n_sim), each = n_units * n_day)

# (b) milk_unit
#Make a vector for "milk_unit" by repeating the sequence of 1:n_units by n_day * n_sim
milk_unit <- rep(seq(1, n_units), times = n_day * n_sim) 

# (c) STorAT
# Make an empty vector for "STorAT" with the length of n_sim * n_units * n_day
STorAT <- vector(mode="logical", n_sim * n_units * n_day) 

# (d) day
#Make a vector repeating days in shelf life that are simulated for each simulation run (i.e., each bulk tank) 
day <- rep(rep(seq(start_day, start_day+n_day-1), each = n_units), times = n_sim) 

# (e) count
#Make an empty vector for "count" with the length of n_sim * n_units * n_day
count <- vector(mode = "logical", n_sim * n_units * n_day) 

# (f) spoilage_type
#Make an empty vector for "spoilage_type" with the length of n_sim * n_units * n_day
spoilage_type <- vector(mode = "logical", n_sim * n_units * n_day) 
```

iii. Prep dataframe using vectors above (each vector becomes a column)
```{r}
data <- data.frame(lot_id, milk_unit, STorAT, spoilage_type, day, count)
```

## 4. Prepare distributions using input data
a. Initial contamination: logMPN normal distribution
b. Frequency of allelic types
c. Temperature distribution for each stage 
d. Frequency of PPC (i.e., spoilage_type)
```{r}
## (a) Initial contamination: logMPN normal distribution (note: How is the initialcount_import data used? Where did logMPN_mean and logMPN_sd come from?)

# determine appropriate normal distribution based on input data 
# (i) spore data
spore_init_file$log10left <- log10(spore_init_file$left)
spore_init_file$log10right <- log10(spore_init_file$right)
spore_init_file$log10MPN <- log10(spore_init_file$MPN)
cens_data <- spore_init_file[,c("log10left","log10right")]
names(cens_data) <- c("left","right")
spore_fit <- fitdistcens(censdata = cens_data,distr = "norm")
hist(spore_init_file$log10MPN,freq=F,xlim = c(-4,4))
curve(dnorm(x,mean=spore_fit$estimate[1],sd = spore_fit$estimate[2]),add=T)
plot(spore_fit)
summary(spore_fit)

spore_log10MPN_mean <- spore_fit$estimate[1]
spore_log10MPN_sd <- spore_fit$estimate[2]

# (ii) ppc data; https://stats.stackexchange.com/questions/132652/how-to-determine-which-distribution-fits-my-data-best
# looks like the lowest values are too low so temp change to -3
ppc_init_file$log10CFU[ppc_init_file$log10CFU < -4] <- -3

#fit 
ppc_fit <- fitdist(data = ppc_init_file$log10CFU,distr = "norm") #TO DO: find the best fitting distribution; not normal 
plot(ppc_fit) #fit looks OK
summary(ppc_fit)

ppc_log10CFU_mean <- ppc_fit$estimate[1]
ppc_log10CFU_sd <- ppc_fit$estimate[2]

## (b) Frequency of allelic types
#Here, the "distribution" of STs or ATs are taken directly from the input file by creating a vector of the ST or AT in each of the rows in the the column containing the ST or AT
# (i) spore data
AT_freq <- spore_ATfreq_import$ClosestAT 
# (ii) ppc data
ST_freq <- ppc_STfreq_import$ClosestST 

## (c) Temperature distribution for each stage (Note for Sarah to fix)
#Here, the distribution and parameters are currently already written into the input file
# temp_by_stage

## (d) Frequency of PPC

# PPC_freq <- as.character(freq_spoilageType$spoilagetype)
# PPC_freq <- as.character(df_freqPPC$exceed20000_d10) #can change this to change by samplings or plants (or can rewrite code below)
```

## 5. Sample distributions

i. Sample distributions
    a. Sample MPN_init from the initial MPN
    b. Sample whether PPC from PPC_freq
    c. Sample AT from AT_freq
    d. Sample temp from temp_by_stage
```{r}
## (a) Sample init_count from both the spore & ppc data
# (i) spore
#Sample the spore_log10MPN distribution 
spore_log10MPN_samp <- rnorm(n_sim, spore_log10MPN_mean, spore_log10MPN_sd) 

#Convert spore_log10MPN_samp back to spore_MPN_samp
spore_MPN_samp <- 10^spore_log10MPN_samp

#Convert MPN for each sample (here, unique for each simulation aka lot) to equivalent in milk unit of interest (here, unit = half gallon; 1892.71 mL in half gallon)
spore_MPN_samp_halfgal <- spore_MPN_samp * 1900

#Sample the MPN_init distribution
spore_MPN_init<-vector()
for (i in 1:n_sim){
  spore_MPN_init_samp <-rep(rpois(n_units, spore_MPN_samp_halfgal[i]), times = n_day)
  spore_MPN_init<-c(spore_MPN_init, spore_MPN_init_samp)}

# (ii) ppc
#Sample the ppc_log10CFU distribution 
ppc_log10CFU_samp <- rnorm(n_sim, ppc_log10CFU_mean, ppc_log10CFU_sd) 

#Convert ppc_log10MPN_samp back to spore_MPN_samp
ppc_CFU_samp <- 10^ppc_log10CFU_samp

#Convert CFU for each sample (here, unique for each simulation aka lot) to equivalent in milk unit of interest (here, unit = half gallon; 1892.71 mL in half gallon)
ppc_CFU_samp_halfgal <- ppc_CFU_samp * 1900

#Sample the CFU_init distribution
ppc_CFU_init<-vector()
for (i in 1:n_sim){
  ppc_CFU_init_samp <-rep(rpois(n_units, ppc_CFU_samp_halfgal[i]), times = n_day)
  ppc_CFU_init<-c(ppc_CFU_init, ppc_CFU_init_samp)}

## (b) Sample the PPC_freq distribution 
spoilage_ppc <- vector()
for (i in 1:n_sim){
  spoilage_ppc_samp <- rep(sample(PPC_freq, n_units, replace = T), times = n_day)
  spoilage_ppc <- c(spoilage_ppc, spoilage_ppc_samp)}

## (c) Sample from ATorST from AT_freq and ST_freq distributions, respectively
# (i) sample AT_freq 
AT <- vector()
for (i in 1:n_sim){
 AT_samp <- rep(sample(AT_freq, n_units, replace = T), times = n_day)
  AT <- c(AT, AT_samp)}

# (ii) sample ST_freq
ST <- vector()
for (i in 1:n_sim){
 ST_samp <- rep(sample(ST_freq, n_units, replace = T), times = n_day)
  ST <- c(ST, ST_samp)}

## (d) Sample the temperature distribution # Sarah figure out how to implement Laplace distribution
# temps <- vector()
# for (i in 1:n_sim){
#   temp_samp <- rep(rlaplace(n_units, m=4.06, s=2.31), times = n_day)
#                    temps <- c(temps,temp_samp)} # probably should doublecheck before publish; https://doi.org/10.4315/0362-028X-73.2.312

# temps <- vector()
# for (i in 1:n_sim){
#   for (j in 1:nrow(temp_by_stage)){
#     stage_row <- temp_by_stage[j, ]
#     n_times <- stage_row$endTime - stage_row$beginTime + 1
#     params <- as.numeric(unlist(strsplit(stage_row$parameters, " ")))
#     temp_mean <- params[[1]]
#     temp_sd <- params[[2]]
#     temp_sample <- rep(rnorm(n_units, temp_mean, temp_sd), times = n_times)
#     temps <- c(temps, temp_sample)}}
```

ii. Add results from sampling distribution in (i) to dataframe
```{r}
## (a) add spoilage_ppc to dataframe
spoilage_ppc<-as.factor(spoilage_ppc)
# levels(spoilage_ppc)[levels(spoilage_ppc)=="1"] <- "spore"

levels(spoilage_ppc)[levels(spoilage_ppc)=="1"] <- "ppc"
levels(spoilage_ppc)[levels(spoilage_ppc)=="2"] <- "spore"

# levels(spoilage_ppc)[levels(spoilage_ppc)=="1"] <- "NotSpoiled"
# levels(spoilage_ppc)[levels(spoilage_ppc)=="2"] <- "ppc"
# levels(spoilage_ppc)[levels(spoilage_ppc)=="3"] <- "spore"

data$spoilage_type <- spoilage_ppc

## (a) Reformat and add initial log10CFU & log10MPN to dataframe
# (i) spore
#First convert spore_MPN_init from half-gallon to mLs
spore_MPN_init_mL <- spore_MPN_init / 1900
#Also need to remove 0's from the data and replace with detection limit
spore_MPN_init_mL[spore_MPN_init_mL == 0] <- 0.01;
#Add ppc_log10CFU_init to dataframe
data$spore_log10MPN_init <- log10(spore_MPN_init_mL) #change this for the bactofuge; Moraru = 0.90 log reduction and TetraPak = 1.30 log reduction

#(ii) ppc
#First convert ppc_CFU_init from half-gallon to mLs
ppc_CFU_init_mL <- ppc_CFU_init / 1900
#Also need to remove 0's from the data and replace with detection limit (check if 0.01 is actually detection limit)
ppc_CFU_init_mL[ppc_CFU_init_mL == 0] <- 0.01;
#Add ppc_log10CFU_init to dataframe
data$ppc_log10CFU_init <- log10(ppc_CFU_init_mL) 

#(iii) logCount_init;  #after run the simulation need to replace "NotSpoiled" with 0 or NotSpoiled
data$logCount_init <- data$spoilage_type
data$logCount_init <- with(data, ifelse( logCount_init == "spore", spore_log10MPN_init, ppc_log10CFU_init ) )

## (b) Add AT to dataframe column STorAT
#(i) spore
data$AT <- AT
#(ii) ppc
data$ST <- ST
# (iii) STorAT
data$STorAT <- data$spoilage_type
data$STorAT <- with(data, ifelse( STorAT == "spore", AT, ST) )

## (c) #Add temp to dataframe
# data$temp <- temps

# OR just set what the temperature should be for all:
data$temp <- 7.2 # constant temp for Buffalo

```

iii. Prepare empty vectors for newTemp, newMu, newLag with length n_sim * n_units * n_day
```{r}
data$newTemp <- vector(mode="logical", n_sim * n_units * n_day)
data$newMu <- vector(mode="logical", n_sim * n_units * n_day)
data$newLag <- vector(mode="logical", n_sim * n_units * n_day)
```

iv. join growth_import files
```{r}
growth_import <- rbind(ppc_growth_import,spore_growth_import)
```

## 6. Calculate log10N for each row in dataframe
```{r}
##Get the ST or AT and day from the data frame, get growth parameters depending on the ST or AT
# Simulation   ----
# for (i in 1:(n_sim * n_units * n_day)) {
#   #Find row in growth parameter data that corresponds to allele sample
#   allele_index <- which(growth_import$STorAT == data$STorAT[i])
#   row <- data[i,]
#   prev_row <- getPrevRow(data, row$lot_id, row$milk_unit, row$day)
#   update <- ifelse(nrow(prev_row) == 0 || row$temp != prev_row$temp, T, F)
#   
#   #calculate the new growth parameters using the square root model and our sampled temperature
#   newT <- row$temp
#   newLag <- ifelse(update,
#                    lagAtNewTemp(row$day, newT, growth_import$lag[allele_index]),
#                    prev_row$newLag)
#   old_lag <- ifelse(row$day == 1, newLag, prev_row$newLag)
#   # newLag <- ifelse(update & row$day <= old_lag & row$day > 1,
#   #                  adjustLag(row$day, old_lag, newLag),
#   #                  old_lag)
#   newLag <- ifelse(update & row$day > 1,
#                    adjustLag(row$day, old_lag, newLag, restartExp = F),
#                    old_lag)
#   newMu <-  ifelse(update,
#                    muAtNewTemp(newT, growth_import$mumax[allele_index]),
#                    prev_row$newMu)
#   data$newTemp[i] <- newT
#   data$newLag[i] <- newLag
#   data$newMu[i] <- newMu
#   
#   #Calculate the log10N count using our new growth parameters
#   new_spore_count <-
#     log10N_func(row$day,
#                 newLag,
#                 newMu,
#                 (data$logCount_init[i]),  #-0.90 for Moraru; -1.30 for TetraPak
#                 growth_import$LOG10Nmax[allele_index])
#   old_spore_count <-
#     log10N_func(row$day - 1,
#                 newLag,
#                 newMu,
#                 (data$logCount_init[i]),  #-0.90 for Moraru; -1.30 for TetraPak
#                 growth_import$LOG10Nmax[allele_index])
#   data$spore_count[i] <- ifelse(row$day == 1, new_spore_count,
#                           prev_row$spore_count + (new_spore_count - old_spore_count))
#   #Calculate the log10N ppc_count using our new growth parameters
#   new_ppc_count <-
#     log10N_func(row$day*24,
#                 newLag,
#                 newMu,
#                 data$logCount_init[i],
#                 growth_import$LOG10Nmax[allele_index])
#   old_ppc_count <-
#     log10N_func((row$day - 1)*24,
#                 newLag,
#                 newMu,
#                 data$logCount_init[i],
#                 growth_import$LOG10Nmax[allele_index])
#   data$ppc_count[i] <- ifelse(row$day == 1, new_ppc_count,
#                           prev_row$ppc_count + (new_ppc_count - old_ppc_count))
# }

```

* Run simple version (not including stages)
    *put count for spore and ppc in different columns for now since data had been hour previously for ppc
```{r}
for (i in 1:(n_sim * n_units * n_day)) {
  allele_index <- which(growth_import$STorAT == data$STorAT[i])
  row <- data[i,]
  prev_row <- getPrevRow(data, row$lot_id, row$milk_unit, row$day)
  update <-
    ifelse(nrow(prev_row) == 0 || row$temp != prev_row$temp, T, F)
  data$spore_count[i] <-
    log10N_func(
      data$day[i],
      growth_import$lag[allele_index],
      growth_import$mumax[allele_index],
      (data$logCount_init[i]), #-0.90 for Moraru; -1.30 for TetraPak
      growth_import$LOG10Nmax[allele_index]
    )
  # data$ppc_count[i] <-
  #   log10N_func(
  #     data$day[i] * 24,
  #     growth_import$lag[allele_index],
  #     growth_import$mumax[allele_index],
  #     data$logCount_init[i],
  #     growth_import$LOG10Nmax[allele_index]
  #   )
}
```
* Get count data
```{r}
data$count_temp <- data$spoilage_type
data$count_temp <- with(data, ifelse( count_temp == "spore", spore_count, ppc_count ) )
data$count <- with(data, ifelse( spoilage_type == "NotSpoiled", 0, count_temp ) )
```

## 7. Save results
```{r}
# data_NB_MeanSpoilType_LT <- data
# save(data_NB_MeanSpoilType_LT,file="Baseline_Buffalo_NoBactofuge_AverageSpoilageType_LaplaceTemp_MCsim_result_df.RData")

# data_MB_MeanSpoilType_LT <- data
# save(data_MB_MeanSpoilType_LT,file="Baseline_Buffalo_MoraruBactofuge_AverageSpoilageType_LaplaceTemp_MCsim_result_df.RData")

# data_TB_MeanSpoilType_LT <- data
# save(data_TB_MeanSpoilType_LT,file="Baseline_Buffalo_TetraPakBactofuge_AverageSpoilageType_LaplaceTemp_MCsim_result_df.RData")

# data_NB_MeanSpoilType_CT <- data
# save(data_NB_MeanSpoilType_CT,file="Baseline_Buffalo_NoBactofuge_AverageSpoilageType_ConstantTemp_MCsim_result_df.RData")

# data_MB_MeanSpoilType_CT <- data
# save(data_MB_MeanSpoilType_CT,file="Baseline_Buffalo_MoraruBactofuge_AverageSpoilageType_ConstantTemp_MCsim_result_df.RData")

# data_TB_MeanSpoilType_CT <- data
# save(data_TB_MeanSpoilType_CT,file="Baseline_Buffalo_TetraPakBactofuge_AverageSpoilageType_ConstantTemp_MCsim_result_df.RData")


# data_NB_BestPPCVSL436_LT <- data
# save(data_NB_BestPPCVSL436_LT,file="Buffalo_NoBactofuge_BestPPCVSL436_LaplaceTemp_MCsim_result_df.RData")

# data_MB_BestPPCVSL436_LT <- data
# save(data_MB_BestPPCVSL436_LT,file="Buffalo_MoraruBactofuge_BestPPCVSL436_LaplaceTemp_MCsim_result_df.RData")

# data_TB_BestPPCVSL436_LT <- data
# save(data_TB_BestPPCVSL436_LT,file="Buffalo_TetraPakBactofuge_BestPPCVSL436_LaplaceTemp_MCsim_result_df.RData")

# data_TB_BestPPCVSL436_CT <- data
# save(data_TB_BestPPCVSL436_CT,file="Buffalo_TetraPakBactofuge_BestPPCVSL436_ConstantTemp_MCsim_result_df.RData")

# data_MB_BestPPCVSL436_CT <- data
# save(data_MB_BestPPCVSL436_CT,file="Buffalo_MoraruBactofuge_BestPPCVSL436_ConstantTemp_MCsim_result_df.RData")
# data_NB_BestPPCVSL436_CT <- data
# save(data_NB_BestPPCVSL436_CT,file="Buffalo_NoBactofuge_BestPPCVSL436_ConstantTemp_MCsim_result_df.RData")


# data_NB_WorstPPCVSL434_CT <- data
# save(data_NB_WorstPPCVSL434_CT,file="Buffalo_NoBactofuge_WorstPPCVSL434_ConstantTemp_MCsim_result_df.RData")
# 
# data_MB_WorstPPCVSL434_CT <- data
# save(data_MB_WorstPPCVSL434_CT,file="Buffalo_MoraruBactofuge_WorstPPCVSL434_ConstantTemp_MCsim_result_df.RData")

# data_TB_WorstPPCVSL434_CT <- data
# save(data_TB_WorstPPCVSL434_CT,file="Buffalo_TetraPakBactofuge_WorstPPCVSL434_ConstantTemp_MCsim_result_df.RData")

# data_NB_WorstPPCVSL434_LT <- data
# save(data_NB_WorstPPCVSL434_LT,file="Buffalo_NoBactofuge_WorstPPCVSL434_LaplaceTemp_MCsim_result_df.RData")

# data_MB_WorstPPCVSL434_LT <- data
# save(data_MB_WorstPPCVSL434_LT,file="Buffalo_MoraruBactofuge_WorstPPCVSL434_LaplaceTemp_MCsim_result_df.RData")

# data_TB_WorstPPCVSL434_LT <- data
# save(data_TB_WorstPPCVSL434_LT,file="Buffalo_TetraPakBactofuge_WorstPPCVSL434_LaplaceTemp_MCsim_result_df.RData")



```




